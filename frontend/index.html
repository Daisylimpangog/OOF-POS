<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OOF POS - Deliveries & Sales System</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginContainer" class="login-container active">
        <div class="login-box">
            <div class="login-header">
                <div class="login-logo">
                    <img src="images/oikos-logo.png" alt="OIKOS Logo" class="login-logo-image">
                </div>
                <p style="font-size: 0.9em; color: #6B5344; margin-top: 12px;">OOF POS System</p>
            </div>

            <form onsubmit="handleLogin(event)" class="login-form">
                <div class="form-group">
                    <label for="loginPassword">Enter Password</label>
                    <input 
                        type="password" 
                        id="loginPassword" 
                        placeholder="Enter your password" 
                        required 
                        autofocus
                    >
                    <div class="password-toggle" onclick="togglePasswordVisibility()">
                        üëÅÔ∏è
                    </div>
                </div>

                <button type="submit" class="btn btn-primary login-btn">
                    üîì Login
                </button>

                <div id="loginError" class="login-error"></div>
            </form>

            <div class="login-footer">
                <p>¬© 2026 OIKOS Orchard & Farm. All rights reserved.</p>
            </div>
        </div>
    </div>

    <div class="app-wrapper active" id="appWrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="images/oikos-logo.png" alt="OIKOS Logo" class="sidebar-logo-image">
                </div>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-module="dashboard">
                    <span class="nav-icon">üìà</span>
                    <span class="nav-label">Dashboard</span>
                </button>
                <button class="nav-item" data-module="sales">
                    <span class="nav-icon">üì¶</span>
                    <span class="nav-label">Sales</span>
                </button>
                <button class="nav-item" data-module="deliveries">
                    <span class="nav-icon">üöö</span>
                    <span class="nav-label">Deliveries</span>
                </button>
                <button class="nav-item" data-module="summary">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Analytics</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="nav-item" onclick="openManagementMenu()">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-label">Management</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-wrapper">
            <!-- Header Bar -->
            <header class="top-header">
                <div class="header-title">
                    <h1 id="headerTitle">Sales Management</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-theme btn-sm" id="themeToggle" title="Toggle Dark Mode">üåô</button>
                    <button class="btn btn-info btn-sm" onclick="toggleRightSidebar()">‚ò∞ Quick Info</button>
                    <button class="btn btn-primary btn-sm" id="addNewBtn" onclick="openSalesModal()">+ Add Sale</button>
                    <button class="btn btn-danger btn-sm" onclick="logout()" title="Logout">üîì Logout</button>
                </div>
            </header>

            <!-- Content Area -->
            <main class="main-content">
                <!-- Dashboard Module -->
                <section id="dashboard" class="module active">
                    <div class="filter-tabs">
                        <label style="font-weight: 600; color: #1a202c;">üìÖ Select Date Range:</label>
                        <input type="date" id="dashboardDateFrom" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="date" id="dashboardDateTo" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <button class="btn btn-info btn-sm" onclick="loadDashboard()">üîç Load Dashboard</button>
                        <button class="btn btn-warning btn-sm" onclick="resetDashboardFilters()">‚Ü∫ Reset</button>
                    </div>

                    <div class="cards-grid">
                        <!-- Key Metrics -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>üìä Key Metrics</h3>
                            <div class="summary-box">
                                <div class="summary-item">
                                    <span>Total Sales:</span>
                                    <strong id="dashTotalSales">‚Ç±0.00</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Total Transactions:</span>
                                    <strong id="dashTotalTransactions">0</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Total Quantity (kg):</span>
                                    <strong id="dashTotalQuantity">0 kg</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Average Order Value:</span>
                                    <strong id="dashAvgOrderValue">‚Ç±0.00</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Top 5 Products by Sales -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>üèÜ Top 5 Products by Sales Amount</h3>
                            <div id="dashTopProducts" class="dashboard-table"></div>
                        </div>

                        <!-- Top 5 Products by Quantity -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>ü•á Top 5 Products by Quantity Sold</h3>
                            <div id="dashTopProductsQty" class="dashboard-table"></div>
                        </div>

                        <!-- Sales by Category -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>üìÇ Sales by Category</h3>
                            <div id="dashSalesByCategory" class="dashboard-table"></div>
                        </div>

                        <!-- Delivery Stats -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>üöö Delivery Statistics</h3>
                            <div class="summary-box">
                                <div class="summary-item">
                                    <span>Total Deliveries:</span>
                                    <strong id="dashTotalDeliveries">0</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Completed:</span>
                                    <strong id="dashCompletedDeliveries">0</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Pending:</span>
                                    <strong id="dashPendingDeliveries">0</strong>
                                </div>
                                <div class="summary-item">
                                    <span>Returns:</span>
                                    <strong id="dashReturnedDeliveries">0</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Store Performance -->
                        <div class="summary-section" style="grid-column: span 2;">
                            <h3>üè™ Sales by Store</h3>
                            <div id="dashSalesByStore" class="dashboard-table"></div>
                        </div>
                    </div>
                </section>

                <!-- Sales Module -->
                <section id="sales" class="module active">
                    <!-- Sales Summary Section -->
                    <div class="summary-section">

                    <!-- Sales Summary Section -->
                    <div class="summary-section">
                        <h3>üìä Sales Summary</h3>
                        <div class="summary-box">
                            <div class="summary-item">
                                <span>Total Sales Amount:</span>
                                <strong id="totalSales">‚Ç±0.00</strong>
                            </div>
                            <div class="summary-item">
                                <span>Total Transactions:</span>
                                <strong id="totalSalesCount">0</strong>
                            </div>
                            <div class="summary-item">
                                <span>Total Quantity (kg):</span>
                                <strong id="totalSalesKg">0 kg</strong>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Management Table -->
                    <div class="summary-section" style="margin-top: 30px;">
                        <h3>üìä Sales Management</h3>
                        <div class="filter-tabs" style="margin-bottom: 15px;">
                            <input type="date" id="filterSalesManagementDateFrom" placeholder="From Date" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <input type="date" id="filterSalesManagementDateTo" placeholder="To Date" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <select id="filterSalesManagementCategory" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                                <option value="">All Categories</option>
                                <option value="HERBS">üåø HERBS</option>
                                <option value="CROPS">üåæ CROPS</option>
                                <option value="FRUITS">üçé FRUITS</option>
                                <option value="VEGETABLES">ü•¨ VEGETABLES</option>
                                <option value="SPICES">üå∂Ô∏è SPICES</option>
                                <option value="EDIBLE FLOWERS">üå∏ FLOWERS</option>
                                <option value="FROM THE WILD">üåø WILD</option>
                                <option value="EGGS & MEAT">ü•ö MEAT</option>
                                <option value="SLOW FRESH DRINKS">ü•§ DRINKS</option>
                            </select>
                            <button class="btn btn-info btn-sm" onclick="applySalesManagementFilters()">üîç Filter</button>
                            <button class="btn btn-warning btn-sm" onclick="resetSalesManagementFilters()">‚Ü∫ Reset</button>
                            <button class="btn btn-primary btn-sm" onclick="openSalesModal()">+ Add Sales</button>
                            <button class="btn btn-success btn-sm" onclick="printSalesManagement()" style="margin-left: auto;">üñ®Ô∏è Print</button>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Category</th>
                                        <th>Store</th>
                                        <th>Quantity (kg)</th>
                                        <th>Amount</th>
                                        <th>Remaining Qty (kg)</th>
                                        <th>Actual Deliveries (kg)</th>
                                        <th>Sale Date</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="salesManagementTable">
                                    <tr><td colspan="10" class="text-center">Loading sales data...</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- Pagination Controls for Sales Management -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                <span id="salesManagementPaginationInfo">Showing 0 of 0 transactions</span>
                            </div>
                            <div class="pagination-controls">
                                <button class="btn btn-sm btn-secondary" onclick="previousSalesManagementPage()" id="salesManagementPrevBtn">‚Üê Previous</button>
                                <span id="salesManagementPageNumbers" class="pagination-numbers"></span>
                                <button class="btn btn-sm btn-secondary" onclick="nextSalesManagementPage()" id="salesManagementNextBtn">Next ‚Üí</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Deliveries Module -->
                <section id="deliveries" class="module">
                    <!-- Delivery Summary Section -->
                    <div class="summary-section">
                        <h3>üì¶ Deliveries Summary</h3>
                        <div class="summary-box">
                            <div class="summary-item">
                                <span>Total Deliveries:</span>
                                <strong id="totalDeliveries">0</strong>
                            </div>
                            <div class="summary-item">
                                <span>Total Quantity (kg):</span>
                                <strong id="totalDeliveriesKg">0 kg</strong>
                            </div>
                            <div class="summary-item">
                                <span>Completed:</span>
                                <strong id="completedDeliveries">0</strong>
                            </div>
                            <div class="summary-item">
                                <span>Pending:</span>
                                <strong id="pendingDeliveries">0</strong>
                            </div>
                        </div>
                    </div>

                    <!-- Deliveries History Table -->
                    <div class="summary-section" style="margin-top: 20px;">
                        <h3>üìã Deliveries History</h3>
                        <div class="filter-tabs" style="margin-bottom: 15px;">
                            <input type="date" id="filterDeliveryDateFrom" placeholder="From Date" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <input type="date" id="filterDeliveryDateTo" placeholder="To Date" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <select id="filterDeliveryStatus" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                                <option value="">All Status</option>
                                <option value="pending">‚è≥ Pending</option>
                                <option value="completed">‚úì Completed</option>
                                <option value="returned">‚Ü©Ô∏è Returned</option>
                            </select>
                            <button class="btn btn-info btn-sm" onclick="applyDeliveryFilters()">üîç Filter</button>
                            <button class="btn btn-warning btn-sm" onclick="resetDeliveryFilters()">‚Ü∫ Reset</button>
                            <button class="btn btn-primary btn-sm" onclick="openDeliveryModal()">+ Add Deliveries</button>
                            <button class="btn btn-success btn-sm" onclick="printDeliveriesHistory()" style="margin-left: auto;">üñ®Ô∏è Print</button>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Category</th>
                                        <th>Store</th>
                                        <th>Receiver</th>
                                        <th>Quantity Deliver (kg)</th>
                                        <th>Sold Quantity (kg)</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="deliveriesTable">
                                    <tr><td colspan="9" class="text-center">Loading deliveries data...</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- Pagination Controls for Deliveries -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                <span id="deliveriesPaginationInfo">Showing 0 of 0 transactions</span>
                            </div>
                            <div class="pagination-controls">
                                <button class="btn btn-sm btn-secondary" onclick="previousDeliveriesPage()" id="deliveriesPrevBtn">‚Üê Previous</button>
                                <span id="deliveriesPageNumbers" class="pagination-numbers"></span>
                                <button class="btn btn-sm btn-secondary" onclick="nextDeliveriesPage()" id="deliveriesNextBtn">Next ‚Üí</button>
                            </div>
                        </div>
                    </div>
                </section>

            <!-- Summary Module -->
            <section id="summary" class="module">
                <div class="filter-tabs">
                    <label style="font-weight: 600; color: #1a202c;">Select Month & Year:</label>
                    <input type="month" id="summaryMonth" value="" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                    <button class="tab-btn" onclick="loadMergedSummary()">üìä Load Report</button>
                    <button class="btn btn-success btn-sm" onclick="downloadMergedPDF()">üì• Download PDF</button>
                    <button class="btn btn-info btn-sm" onclick="printOverallReport()" style="margin-left: auto;">üñ®Ô∏è Print Overall Report</button>
                </div>

                <div class="cards-grid">
                    <!-- Sales Summary Section -->
                    <div class="summary-section" style="grid-column: span 2;">
                        <h3>üìà Monthly Sales Summary</h3>
                        <div class="summary-box">
                            <div class="summary-item" style="cursor: pointer;" onclick="showSalesDetailModal('all')">
                                <span>Total Sales Amount:</span>
                                <strong id="summaryTotalSales">‚Ç±0.00</strong>
                            </div>
                            <div class="summary-item" style="cursor: pointer;" onclick="showSalesDetailModal('quantity')">
                                <span>Total Sales Quantity:</span>
                                <strong id="summaryTotalSalesQty">0 kg</strong>
                            </div>
                        </div>

                        <!-- Sales By Category -->
                        <div style="margin-top: 20px;">
                            <h4 style="color: #1a202c; margin-bottom: 12px; font-weight: 600;">Sales by Category:</h4>
                            <div class="summary-box">
                                <div class="summary-item" style="cursor: pointer;" onclick="showSalesDetailModal('HERBS')">
                                    <span>üåø HERBS:</span>
                                    <strong id="summaryHerbsSales">‚Ç±0.00</strong>
                                </div>
                                <div class="summary-item" style="cursor: pointer;" onclick="showSalesDetailModal('CROPS')">
                                    <span>üåæ CROPS:</span>
                                    <strong id="summaryCropsSales">‚Ç±0.00</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Deliveries Summary Section -->
                    <div class="summary-section" style="grid-column: span 2;">
                        <h3>üì¶ Monthly Deliveries Summary</h3>
                        <div class="summary-box">
                            <div class="summary-item" style="cursor: pointer;" onclick="showDeliveryDetailModal('all')">
                                <span>Total Deliveries:</span>
                                <strong id="summaryTotalDeliveries">0</strong>
                            </div>
                        </div>

                        <!-- Deliveries by Status -->
                        <div style="margin-top: 20px;">
                            <h4 style="color: #1a202c; margin-bottom: 12px; font-weight: 600;">Returns & Issues:</h4>
                            <div class="summary-box">
                                <div class="summary-item" style="cursor: pointer;" onclick="showReturnedProductsModal()">
                                    <span>Returned Products:</span>
                                    <strong id="summaryReturnedDeliveries">0</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            </main>
        </div>
        <!-- Right Sidebar -->
        <aside class="right-sidebar" id="rightSidebar">
            <div class="right-sidebar-header">
                <h3>üìä Quick Info</h3>
                <button class="right-sidebar-close" onclick="toggleRightSidebar()">‚úï</button>
            </div>

            <div class="right-sidebar-content">
                <!-- Quick Stats Section -->
                <div class="right-panel-section">
                    <h4>Today's Overview</h4>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-details">
                            <span class="stat-label">Today's Sales</span>
                            <span class="stat-value" id="todaysSalesAmount">‚Ç±0.00</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-details">
                            <span class="stat-label">Sales Count</span>
                            <span class="stat-value" id="todaysSalesCount">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üöö</div>
                        <div class="stat-details">
                            <span class="stat-label">Deliveries Today</span>
                            <span class="stat-value" id="todaysDeliveries">0</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions Section -->
                <div class="right-panel-section">
                    <h4>Quick Actions</h4>
                    <button class="quick-action-btn" onclick="openSalesModal()">‚ûï Add Sale</button>
                    <button class="quick-action-btn" onclick="openDeliveryModal()">üì¶ Add Delivery</button>
                    <button class="quick-action-btn" onclick="openAddProductModal()">üìù Add Product</button>
                    <button class="quick-action-btn" onclick="openAddStoreModal()">üè™ Add Store</button>
                </div>

                <!-- Recent Transactions Section -->
                <div class="right-panel-section">
                    <h4>Recent Transactions</h4>
                    <div class="recent-list" id="recentTransactions">
                        <p class="text-muted">No recent transactions</p>
                    </div>
                </div>

                <!-- Store Status Section -->
                <div class="right-panel-section">
                    <h4>Store Status</h4>
                    <div class="store-status-list" id="storeStatusList">
                        <p class="text-muted">Loading stores...</p>
                    </div>
                </div>

                <!-- Pending Tasks Section -->
                <div class="right-panel-section">
                    <h4>Pending Deliveries</h4>
                    <div class="pending-list" id="pendingDeliveriesList">
                        <p class="text-muted">No pending deliveries</p>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- List of Products Modal -->
    <div id="productListModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>üìã List of Products</h3>
                <button class="close" onclick="closeProductListModal()">&times;</button>
            </div>
            <div style="padding: 20px;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Product Name</th>
                            <th>Category</th>
                            <th>Pack Size</th>
                            <th>Retail Price</th>
                            <th>Institutional Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsListTable">
                        <tr><td colspan="7" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
                <!-- Pagination Controls for Products -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        <span id="productsPaginationInfo">Showing 0 of 0 products</span>
                    </div>
                    <div class="pagination-controls">
                        <button class="btn btn-sm btn-secondary" id="productsPrevBtn" onclick="previousProductsPage()">‚Üê Previous</button>
                        <span id="productsPageNumbers" class="pagination-numbers"></span>
                        <button class="btn btn-sm btn-secondary" id="productsNextBtn" onclick="nextProductsPage()">Next ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- List of Stores Modal -->
    <div id="storeListModal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>üìã List of Stores</h3>
                <button class="close" onclick="closeStoreListModal()">&times;</button>
            </div>
            <div style="padding: 20px;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Store Name</th>
                            <th>Address</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="storesListTable">
                        <tr><td colspan="4" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Categories Management Modal -->
    <div id="categoriesModal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>üè∑Ô∏è Categories Management</h3>
                <button class="close" onclick="closeCategoriesModal()">&times;</button>
            </div>
            <div style="padding: 20px;">
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openAddCategoryModal()" style="width: 100%; margin-bottom: 15px;">
                        ‚ûï Add New Category
                    </button>
                </div>
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Category Name</th>
                            <th>Description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="categoriesListTable">
                        <tr><td colspan="4" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add/Edit Category Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="categoryModalTitle">‚ûï Add Category</h3>
                <button class="close" onclick="closeCategoryModal()">&times;</button>
            </div>
            <form onsubmit="saveCategory(event)">
                <div class="form-group">
                    <label>Category Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="categoryName" placeholder="Enter category name" required style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%;">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="categoryDescription" placeholder="Enter category description (optional)" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%;"></textarea>
                </div>
                <input type="hidden" id="categoryId">
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeCategoryModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Category</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sales History Modal -->
    <div id="salesHistoryModal" class="modal">
        <div class="modal-content" style="max-width: 1000px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>üìã Sales History</h3>
                <button class="close" onclick="closeSalesHistoryModal()">&times;</button>
            </div>
            <div style="padding: 20px;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Category</th>
                            <th>Store</th>
                            <th>Quantity (kg)</th>
                            <th>Amount (‚Ç±)</th>
                            <th>Date</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="salesHistoryTable">
                        <tr><td colspan="7" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Deliveries History Modal -->
    <div id="deliveriesHistoryModal" class="modal">
        <div class="modal-content" style="max-width: 1100px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>üìã Deliveries History</h3>
                <button class="close" onclick="closeDeliveriesHistoryModal()">&times;</button>
            </div>
            <div style="padding: 20px;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Category</th>
                            <th>Store</th>
                            <th>Receiver</th>
                            <th>Quantity (kg)</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="deliveriesHistoryTable">
                        <tr><td colspan="8" class="text-center">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Add New Product</h3>
                <button class="close" onclick="closeAddProductModal()">&times;</button>
            </div>
            <form onsubmit="saveProduct(event)">
                <div class="form-group">
                    <label>Product Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="productName" required placeholder="Enter product name">
                </div>
                <div class="form-group">
                    <label>Category <span style="color: #ef4444;">*</span></label>
                    <select id="productCategory" required>
                        <option value="">Select Category</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Pack Size <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="productPackSize" required placeholder="e.g., per kg, 25 kg/week">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Retail Price (‚Ç±)</label>
                        <input type="number" id="productRetailPrice" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Institutional Price (‚Ç±)</label>
                        <input type="number" id="productInstitutionalPrice" step="0.01" placeholder="0.00">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddProductModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="editProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Product</h3>
                <button class="close" onclick="closeEditProductModal()">&times;</button>
            </div>
            <form onsubmit="saveEditProduct(event)">
                <input type="hidden" id="editProductId">
                <div class="form-group">
                    <label>Product Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="editProductName" required placeholder="Enter product name">
                </div>
                <div class="form-group">
                    <label>Category <span style="color: #ef4444;">*</span></label>
                    <select id="editProductCategory" required>
                        <option value="">Select Category</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Pack Size <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="editProductPackSize" required placeholder="e.g., per kg, 25 kg/week">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Retail Price (‚Ç±)</label>
                        <input type="number" id="editProductRetailPrice" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Institutional Price (‚Ç±)</label>
                        <input type="number" id="editProductInstitutionalPrice" step="0.01" placeholder="0.00">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeEditProductModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Store Modal -->
    <div id="addStoreModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üè™ Add New Store</h3>
                <button class="close" onclick="closeAddStoreModal()">&times;</button>
            </div>
            <form onsubmit="saveStore(event)">
                <div class="form-group">
                    <label>Store Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="storeName" required placeholder="Enter store name">
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" id="storeAddress" placeholder="Enter store address (optional)">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddStoreModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Store</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Store Modal -->
    <div id="editStoreModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Store</h3>
                <button class="close" onclick="closeEditStoreModal()">&times;</button>
            </div>
            <form onsubmit="saveEditStore(event)">
                <input type="hidden" id="editStoreId">
                <div class="form-group">
                    <label>Store Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="editStoreName" required placeholder="Enter store name">
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" id="editStoreAddress" placeholder="Enter store address (optional)">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeEditStoreModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Store</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Management Menu Modal -->
    <div id="managementModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>‚öôÔ∏è Management</h3>
                <button class="close" onclick="closeManagementMenu()">&times;</button>
            </div>
            <div style="padding: 20px; text-align: center;">
                <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="openAddProductModal()">
                    ‚ûï Add Product
                </button>
                <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="openAddStoreModal()">
                    üè™ Add Store
                </button>
                <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="openCategoriesModal()">
                    üè∑Ô∏è Categories
                </button>
                <button class="btn btn-info" style="width: 100%; margin-bottom: 10px;" onclick="openProductListModal()">
                    üìã List of Products
                </button>
                <button class="btn btn-info" style="width: 100%; margin-bottom: 10px;" onclick="openStoreListModal()">
                    üìã List of Stores
                </button>
                <button class="btn btn-warning" style="width: 100%; margin-bottom: 10px;" onclick="openSalesHistoryModal()">
                    üìã Sales History
                </button>
                <button class="btn btn-warning" style="width: 100%;" onclick="openDeliveriesHistoryModal()">
                    üìã Deliveries History
                </button>
            </div>
        </div>
    </div>

    <!-- Sales Modal -->
    <div id="salesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Add New Sale</h3>
                <button class="close" onclick="closeSalesModal()">&times;</button>
            </div>
            <form onsubmit="saveSale(event)">
                <div class="form-group">
                    <label>Product <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="saleProductSearch" placeholder="üîç Search product..." style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%; margin-bottom: 10px;">
                    <div id="saleProductSearchResults" style="max-height: 200px; overflow-y: auto; border: 1px solid #d1d5db; border-radius: 6px; display: none;">
                    </div>
                    <select id="saleProduct" required style="margin-top: 10px;"></select>
                </div>
                <div class="form-group">
                    <label>Category <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="saleCategory" readonly placeholder="Auto-populated">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Store <span style="color: #ef4444;">*</span></label>
                        <select id="saleStore" required></select>
                    </div>
                    <div class="form-group">
                        <label>Date <span style="color: #ef4444;">*</span></label>
                        <input type="date" id="saleDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantity (kg) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="saleQuantity" step="0.001" min="0" required>
                    </div>
                    <div class="form-group">
                        <label>Amount (‚Ç±) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="saleAmount" step="0.01" min="0" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="saleNotes" placeholder="Optional notes..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeSalesModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Sale</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delivery Modal -->
    <div id="deliveryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì¶ Add New Delivery</h3>
                <button class="close" onclick="closeDeliveryModal()">&times;</button>
            </div>
            <form onsubmit="saveDelivery(event)">
                <div class="form-group">
                    <label>Product <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="deliveryProductSearch" placeholder="üîç Search product..." style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%; margin-bottom: 10px;">
                    <div id="deliveryProductSearchResults" style="max-height: 200px; overflow-y: auto; border: 1px solid #d1d5db; border-radius: 6px; display: none;">
                    </div>
                    <select id="deliveryProduct" required style="margin-top: 10px;"></select>
                </div>
                <div class="form-group">
                    <label>Category <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="deliveryCategory" readonly placeholder="Auto-populated">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Store <span style="color: #ef4444;">*</span></label>
                        <select id="deliveryStore" required></select>
                    </div>
                    <div class="form-group">
                        <label>Date <span style="color: #ef4444;">*</span></label>
                        <input type="date" id="deliveryDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantity (kg) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="deliveryQuantity" step="0.001" min="0" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Receiver Name <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="deliveryReceiver" required placeholder="Enter receiver name">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="deliveryNotes" placeholder="Optional notes..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeDeliveryModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Delivery</button>
                </div>
            </form>
        </div>
    </div>
                </div>
            </section>
        </main>
    </div>



    <!-- Return Modal -->
    <div id="returnModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Return Product</h3>
                <span class="close" onclick="closeReturnModal()">&times;</span>
            </div>
            <form id="returnForm" onsubmit="submitReturn(event)">
                <div class="form-group">
                    <label>Quantity to Return:</label>
                    <input type="number" id="returnQuantity" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Reason:</label>
                    <textarea id="returnReason" required></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Process Return</button>
                    <button type="button" class="btn btn-secondary" onclick="closeReturnModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sales Detail Modal -->
    <div id="salesDetailModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="salesDetailTitle">Sales Details</h2>
                <button class="close-btn" onclick="closeSalesDetailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Category</th>
                                <th>Store</th>
                                <th>Quantity (kg)</th>
                                <th>Amount</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="salesDetailTable">
                            <tr><td colspan="6" class="text-center">Loading data...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSalesDetailModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Delivery Detail Modal -->
    <div id="deliveryDetailModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="deliveryDetailTitle">Delivery Details</h2>
                <button class="close-btn" onclick="closeDeliveryDetailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Store</th>
                                <th>Receiver</th>
                                <th>Quantity (kg)</th>
                                <th>Status</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="deliveryDetailTable">
                            <tr><td colspan="6" class="text-center">Loading data...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeliveryDetailModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Returned Products Modal -->
    <div id="returnedProductsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>Returned Products</h2>
                <button class="close-btn" onclick="closeReturnedProductsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity Returned (kg)</th>
                                <th>Product Left (kg)</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="returnedProductsTable">
                            <tr><td colspan="4" class="text-center">Loading data...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeReturnedProductsModal()">Close</button>
            </div>
        </div>
    </div>

    <script src="js/main.js?v=2.0"></script>
</body>
</html>
